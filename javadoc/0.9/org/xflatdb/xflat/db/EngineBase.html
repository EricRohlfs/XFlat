<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_45) on Mon Jan 06 22:31:25 CST 2014 -->
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
<title>EngineBase (XFlatDB 0.9 API)</title>
<meta name="date" content="2014-01-06">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="EngineBase (XFlatDB 0.9 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/EngineBase.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/xflatdb/xflat/db/EngineActionEx.html" title="interface in org.xflatdb.xflat.db"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/xflatdb/xflat/db/EngineBase.Row.html" title="class in org.xflatdb.xflat.db"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/xflatdb/xflat/db/EngineBase.html" target="_top">Frames</a></li>
<li><a href="EngineBase.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.xflatdb.xflat.db</div>
<h2 title="Class EngineBase" class="title">Class EngineBase</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.xflatdb.xflat.db.EngineBase</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../org/xflatdb/xflat/db/Engine.html" title="interface in org.xflatdb.xflat.db">Engine</a></dd>
</dl>
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../../org/xflatdb/xflat/engine/CachedDocumentEngine.html" title="class in org.xflatdb.xflat.engine">CachedDocumentEngine</a>, <a href="../../../../org/xflatdb/xflat/db/ShardedEngineBase.html" title="class in org.xflatdb.xflat.db">ShardedEngineBase</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="strong">EngineBase</span>
extends <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="../../../../org/xflatdb/xflat/db/Engine.html" title="interface in org.xflatdb.xflat.db">Engine</a></pre>
<div class="block">The base class for Engine objects.  The Database uses the functionality
 described here to manage engines, so all engine implementations must extend
 this base class.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>gordon</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.Row.html" title="class in org.xflatdb.xflat.db">EngineBase.Row</a></strong></code>
<div class="block">Represents one row in the database.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.RowData.html" title="class in org.xflatdb.xflat.db">EngineBase.RowData</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.SpinDownEvent.html" title="class in org.xflatdb.xflat.db">EngineBase.SpinDownEvent</a></strong></code>
<div class="block">An event object given to the <a href="../../../../org/xflatdb/xflat/db/EngineBase.SpinDownEventHandler.html" title="interface in org.xflatdb.xflat.db"><code>EngineBase.SpinDownEventHandler</code></a> when an
 engine finishes spinning down.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.SpinDownEventHandler.html" title="interface in org.xflatdb.xflat.db">EngineBase.SpinDownEventHandler</a></strong></code>
<div class="block">An event handler for the events fired when an Engine finishes spinning
 down.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected org.apache.commons.logging.Log</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#log">log</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicReference.html?is-external=true" title="class or interface in java.util.concurrent.atomic">AtomicReference</a>&lt;<a href="../../../../org/xflatdb/xflat/db/EngineState.html" title="enum in org.xflatdb.xflat.db">EngineState</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#state">state</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected </code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#EngineBase(java.lang.String)">EngineBase</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;tableName)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected abstract boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#beginOperations()">beginOperations</a></strong>()</code>
<div class="block">Instructs the engine to begin full read/write operations.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#commit(org.xflatdb.xflat.transaction.Transaction, org.xflatdb.xflat.transaction.TransactionOptions)">commit</a></strong>(<a href="../../../../org/xflatdb/xflat/transaction/Transaction.html" title="interface in org.xflatdb.xflat.transaction">Transaction</a>&nbsp;tx,
      <a href="../../../../org/xflatdb/xflat/transaction/TransactionOptions.html" title="class in org.xflatdb.xflat.transaction">TransactionOptions</a>&nbsp;options)</code>
<div class="block">Called when a transaction is committed to write the committed data to disk.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../../org/xflatdb/xflat/transaction/Transaction.html" title="interface in org.xflatdb.xflat.transaction">Transaction</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#ensureWriteReady()">ensureWriteReady</a></strong>()</code>
<div class="block">Called before every write to ensure we are ready to write.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected abstract boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#forceSpinDown()">forceSpinDown</a></strong>()</code>
<div class="block">Forces this engine to immediately release all resources, even if there are
 still outstanding cursors or uncommitted data.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../../org/xflatdb/xflat/convert/ConversionService.html" title="interface in org.xflatdb.xflat.convert">ConversionService</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#getConversionService()">getConversionService</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html?is-external=true" title="class or interface in java.util.concurrent">ScheduledExecutorService</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#getExecutorService()">getExecutorService</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#getId(org.jdom2.Element)">getId</a></strong>(org.jdom2.Element&nbsp;row)</code>
<div class="block">gets the string ID from a row element.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../../../../org/xflatdb/xflat/db/IdGenerator.html" title="class in org.xflatdb.xflat.db">IdGenerator</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#getIdGenerator()">getIdGenerator</a></strong>()</code>
<div class="block">Gets the ID generator which generates IDs for this table.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#getLastActivity()">getLastActivity</a></strong>()</code>
<div class="block">Gets the date at which the last operation was performed on the engine.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../org/xflatdb/xflat/db/EngineState.html" title="enum in org.xflatdb.xflat.db">EngineState</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#getState()">getState</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#getTableLock()">getTableLock</a></strong>()</code>
<div class="block">Obtains a write lock on the table for this thread.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#getTableName()">getTableName</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../../org/xflatdb/xflat/db/EngineTransactionManager.html" title="class in org.xflatdb.xflat.db">EngineTransactionManager</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#getTransactionManager()">getTransactionManager</a></strong>()</code>
<div class="block">Gets the transactionManager.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected abstract boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#hasUncomittedData()">hasUncomittedData</a></strong>()</code>
<div class="block">Checks whether this engine has any transactional updates in an uncommitted 
 or unreverted state.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#loadMetadata(org.jdom2.Element)">loadMetadata</a></strong>(org.jdom2.Element&nbsp;metatdataElement)</code>
<div class="block">Loads metadata from the given element.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#releaseTableLock()">releaseTableLock</a></strong>()</code>
<div class="block">Releases a write lock on the table that was obtained by this thread.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#revert(long, boolean)">revert</a></strong>(long&nbsp;tx,
      boolean&nbsp;isRecovering)</code>
<div class="block">Called when a transaction is committed to revert the given transaction ID.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#saveMetadata(org.jdom2.Element)">saveMetadata</a></strong>(org.jdom2.Element&nbsp;metadataElement)</code>
<div class="block">Saves metadata to the given element.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#setConversionService(org.xflatdb.xflat.convert.ConversionService)">setConversionService</a></strong>(<a href="../../../../org/xflatdb/xflat/convert/ConversionService.html" title="interface in org.xflatdb.xflat.convert">ConversionService</a>&nbsp;conversionService)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#setExecutorService(java.util.concurrent.ScheduledExecutorService)">setExecutorService</a></strong>(<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html?is-external=true" title="class or interface in java.util.concurrent">ScheduledExecutorService</a>&nbsp;service)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#setId(org.jdom2.Element, java.lang.String)">setId</a></strong>(org.jdom2.Element&nbsp;row,
     <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;id)</code>
<div class="block">set the Id of the given row element to the given ID</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#setIdGenerator(org.xflatdb.xflat.db.IdGenerator)">setIdGenerator</a></strong>(<a href="../../../../org/xflatdb/xflat/db/IdGenerator.html" title="class in org.xflatdb.xflat.db">IdGenerator</a>&nbsp;idGenerator)</code>
<div class="block">Sets the ID generator which generates IDs for this table.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#setLastActivity(long)">setLastActivity</a></strong>(long&nbsp;time)</code>
<div class="block">Concurrently updates the lastActivity property to the greater of the
 existing value or the given time.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#setTransactionManager(org.xflatdb.xflat.db.EngineTransactionManager)">setTransactionManager</a></strong>(<a href="../../../../org/xflatdb/xflat/db/EngineTransactionManager.html" title="class in org.xflatdb.xflat.db">EngineTransactionManager</a>&nbsp;transactionManager)</code>
<div class="block">Sets the transactionManager.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected abstract boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#spinDown(org.xflatdb.xflat.db.EngineBase.SpinDownEventHandler)">spinDown</a></strong>(<a href="../../../../org/xflatdb/xflat/db/EngineBase.SpinDownEventHandler.html" title="interface in org.xflatdb.xflat.db">EngineBase.SpinDownEventHandler</a>&nbsp;completionEventHandler)</code>
<div class="block">Instructs this Engine to wrap up its operations in preparation for being
 switched out.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected abstract boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#spinUp()">spinUp</a></strong>()</code>
<div class="block">Initializes the engine and instructs it to begin acquiring the resources
 necessary to function.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/xflatdb/xflat/db/EngineBase.html#writeComplete()">writeComplete</a></strong>()</code>
<div class="block">Called inside a finally block within every write operation -
 this is a synchronizing measure for write locks</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_org.xflatdb.xflat.db.Engine">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.xflatdb.xflat.db.<a href="../../../../org/xflatdb/xflat/db/Engine.html" title="interface in org.xflatdb.xflat.db">Engine</a></h3>
<code><a href="../../../../org/xflatdb/xflat/db/Engine.html#deleteAll(org.xflatdb.xflat.query.XPathQuery)">deleteAll</a>, <a href="../../../../org/xflatdb/xflat/db/Engine.html#deleteRow(java.lang.String)">deleteRow</a>, <a href="../../../../org/xflatdb/xflat/db/Engine.html#insertRow(java.lang.String, org.jdom2.Element)">insertRow</a>, <a href="../../../../org/xflatdb/xflat/db/Engine.html#queryTable(org.xflatdb.xflat.query.XPathQuery)">queryTable</a>, <a href="../../../../org/xflatdb/xflat/db/Engine.html#readRow(java.lang.String)">readRow</a>, <a href="../../../../org/xflatdb/xflat/db/Engine.html#replaceRow(java.lang.String, org.jdom2.Element)">replaceRow</a>, <a href="../../../../org/xflatdb/xflat/db/Engine.html#update(java.lang.String, org.xflatdb.xflat.query.XPathUpdate)">update</a>, <a href="../../../../org/xflatdb/xflat/db/Engine.html#update(org.xflatdb.xflat.query.XPathQuery, org.xflatdb.xflat.query.XPathUpdate)">update</a>, <a href="../../../../org/xflatdb/xflat/db/Engine.html#upsertRow(java.lang.String, org.jdom2.Element)">upsertRow</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="log">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>log</h4>
<pre>protected&nbsp;org.apache.commons.logging.Log log</pre>
</li>
</ul>
<a name="state">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>state</h4>
<pre>protected&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicReference.html?is-external=true" title="class or interface in java.util.concurrent.atomic">AtomicReference</a>&lt;<a href="../../../../org/xflatdb/xflat/db/EngineState.html" title="enum in org.xflatdb.xflat.db">EngineState</a>&gt; state</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="EngineBase(java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>EngineBase</h4>
<pre>protected&nbsp;EngineBase(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;tableName)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getTableName()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTableName</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;getTableName()</pre>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../org/xflatdb/xflat/db/Engine.html#getTableName()">getTableName</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../org/xflatdb/xflat/db/Engine.html" title="interface in org.xflatdb.xflat.db">Engine</a></code></dd>
</dl>
</li>
</ul>
<a name="getState()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getState</h4>
<pre>public&nbsp;<a href="../../../../org/xflatdb/xflat/db/EngineState.html" title="enum in org.xflatdb.xflat.db">EngineState</a>&nbsp;getState()</pre>
</li>
</ul>
<a name="spinUp()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>spinUp</h4>
<pre>protected abstract&nbsp;boolean&nbsp;spinUp()</pre>
<div class="block">Initializes the engine and instructs it to begin acquiring the resources
 necessary to function.  At this point the engine may begin to respond to
 read-only requests, but any write requests MUST block until <a href="../../../../org/xflatdb/xflat/db/EngineBase.html#beginOperations()"><code>beginOperations()</code></a> )
 is called.</div>
</li>
</ul>
<a name="beginOperations()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>beginOperations</h4>
<pre>protected abstract&nbsp;boolean&nbsp;beginOperations()</pre>
<div class="block">Instructs the engine to begin full read/write operations.  At this point this
 engine has full control over the data files.</div>
</li>
</ul>
<a name="spinDown(org.xflatdb.xflat.db.EngineBase.SpinDownEventHandler)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>spinDown</h4>
<pre>protected abstract&nbsp;boolean&nbsp;spinDown(<a href="../../../../org/xflatdb/xflat/db/EngineBase.SpinDownEventHandler.html" title="interface in org.xflatdb.xflat.db">EngineBase.SpinDownEventHandler</a>&nbsp;completionEventHandler)</pre>
<div class="block">Instructs this Engine to wrap up its operations in preparation for being
 switched out.  The engine must be set to read-only mode (write operations
 should throw an exception).  The engine can stay alive until its outstanding
 cursors are closed, but must allow concurrent reads of the file.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>completionEventHandler</code> - An event handler that is notified when
 the Engine has finished spinning down.</dd></dl>
</li>
</ul>
<a name="forceSpinDown()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>forceSpinDown</h4>
<pre>protected abstract&nbsp;boolean&nbsp;forceSpinDown()</pre>
<div class="block">Forces this engine to immediately release all resources, even if there are
 still outstanding cursors or uncommitted data.  Cursors that continue iterating will throw an
 exception that indicates the engine has spun down.  This will be called after a normal
 spin down, or in case of some kind of error to reclaim resources.</div>
</li>
</ul>
<a name="getLastActivity()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastActivity</h4>
<pre>public&nbsp;long&nbsp;getLastActivity()</pre>
<div class="block">Gets the date at which the last operation was performed on the engine.
 This is used by the Database to determine whether this engine needs to
 remain in its cache or if it can be spun down for later.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The date at which the last write or read has occurred, or the date
 of engine creation if no operations have occurred.</dd></dl>
</li>
</ul>
<a name="setLastActivity(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setLastActivity</h4>
<pre>protected&nbsp;void&nbsp;setLastActivity(long&nbsp;time)</pre>
<div class="block">Concurrently updates the lastActivity property to the greater of the
 existing value or the given time.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>time</code> - the time to update lastActivity to, if greater than the existing
 value.</dd></dl>
</li>
</ul>
<a name="getExecutorService()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getExecutorService</h4>
<pre>protected&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html?is-external=true" title="class or interface in java.util.concurrent">ScheduledExecutorService</a>&nbsp;getExecutorService()</pre>
</li>
</ul>
<a name="setExecutorService(java.util.concurrent.ScheduledExecutorService)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setExecutorService</h4>
<pre>protected&nbsp;void&nbsp;setExecutorService(<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html?is-external=true" title="class or interface in java.util.concurrent">ScheduledExecutorService</a>&nbsp;service)</pre>
</li>
</ul>
<a name="getConversionService()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getConversionService</h4>
<pre>protected&nbsp;<a href="../../../../org/xflatdb/xflat/convert/ConversionService.html" title="interface in org.xflatdb.xflat.convert">ConversionService</a>&nbsp;getConversionService()</pre>
</li>
</ul>
<a name="setConversionService(org.xflatdb.xflat.convert.ConversionService)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setConversionService</h4>
<pre>protected&nbsp;void&nbsp;setConversionService(<a href="../../../../org/xflatdb/xflat/convert/ConversionService.html" title="interface in org.xflatdb.xflat.convert">ConversionService</a>&nbsp;conversionService)</pre>
</li>
</ul>
<a name="getTransactionManager()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTransactionManager</h4>
<pre>protected&nbsp;<a href="../../../../org/xflatdb/xflat/db/EngineTransactionManager.html" title="class in org.xflatdb.xflat.db">EngineTransactionManager</a>&nbsp;getTransactionManager()</pre>
<div class="block">Gets the transactionManager.</div>
</li>
</ul>
<a name="setTransactionManager(org.xflatdb.xflat.db.EngineTransactionManager)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setTransactionManager</h4>
<pre>protected&nbsp;void&nbsp;setTransactionManager(<a href="../../../../org/xflatdb/xflat/db/EngineTransactionManager.html" title="class in org.xflatdb.xflat.db">EngineTransactionManager</a>&nbsp;transactionManager)</pre>
<div class="block">Sets the transactionManager.</div>
</li>
</ul>
<a name="getIdGenerator()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getIdGenerator</h4>
<pre>protected&nbsp;<a href="../../../../org/xflatdb/xflat/db/IdGenerator.html" title="class in org.xflatdb.xflat.db">IdGenerator</a>&nbsp;getIdGenerator()</pre>
<div class="block">Gets the ID generator which generates IDs for this table.</div>
</li>
</ul>
<a name="setIdGenerator(org.xflatdb.xflat.db.IdGenerator)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setIdGenerator</h4>
<pre>protected&nbsp;void&nbsp;setIdGenerator(<a href="../../../../org/xflatdb/xflat/db/IdGenerator.html" title="class in org.xflatdb.xflat.db">IdGenerator</a>&nbsp;idGenerator)</pre>
<div class="block">Sets the ID generator which generates IDs for this table.</div>
</li>
</ul>
<a name="ensureWriteReady()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ensureWriteReady</h4>
<pre>protected&nbsp;<a href="../../../../org/xflatdb/xflat/transaction/Transaction.html" title="interface in org.xflatdb.xflat.transaction">Transaction</a>&nbsp;ensureWriteReady()
                                throws <a href="../../../../org/xflatdb/xflat/transaction/TransactionStateException.html" title="class in org.xflatdb.xflat.transaction">TransactionStateException</a></pre>
<div class="block">Called before every write to ensure we are ready to write. <br/>
 This method also checks if there is a current table lock, and increments
 the <a href="../../../../org/xflatdb/xflat/db/EngineBase.html#writesInProgress"><code>writesInProgress</code></a> counter.
 <p/>
 If the engine is spinning down then we throw because engines are read-only
 when spinning down.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/xflatdb/xflat/transaction/TransactionStateException.html" title="class in org.xflatdb.xflat.transaction">TransactionStateException</a></code></dd></dl>
</li>
</ul>
<a name="writeComplete()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeComplete</h4>
<pre>protected&nbsp;void&nbsp;writeComplete()</pre>
<div class="block">Called inside a finally block within every write operation -
 this is a synchronizing measure for write locks</div>
</li>
</ul>
<a name="getTableLock()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTableLock</h4>
<pre>protected&nbsp;void&nbsp;getTableLock()</pre>
<div class="block">Obtains a write lock on the table for this thread.
 <p/>
 New write operations will block until the lock is released with <a href="../../../../org/xflatdb/xflat/db/EngineBase.html#releaseTableLock()"><code>releaseTableLock()</code></a>.
 This method will wait after obtaining the lock until all in-progress write operations
 have terminated.
 <p/>
 Since I don't exactly trust this to never throw an exception, it would of
 course be good practice to always use the following pattern:
 <pre>
 try{
      engine.getTableLock();
 
      //do stuff
 }
 finally{
      engine.releaseTableLock();
 }
 </pre></div>
</li>
</ul>
<a name="releaseTableLock()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>releaseTableLock</h4>
<pre>protected&nbsp;void&nbsp;releaseTableLock()</pre>
<div class="block">Releases a write lock on the table that was obtained by this thread.
 If the current thread did not own the lock then this method does nothing.
 <p/>
 ALWAYS call this in a finally block after calling <a href="../../../../org/xflatdb/xflat/db/EngineBase.html#getTableLock()"><code>getTableLock()</code></a></div>
</li>
</ul>
<a name="saveMetadata(org.jdom2.Element)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>saveMetadata</h4>
<pre>protected&nbsp;void&nbsp;saveMetadata(org.jdom2.Element&nbsp;metadataElement)</pre>
<div class="block">Saves metadata to the given element.  Metadata is things like indexes
 and other configuration.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>metadataElement</code> - The element from which metadata should be loaded.</dd></dl>
</li>
</ul>
<a name="loadMetadata(org.jdom2.Element)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadMetadata</h4>
<pre>protected&nbsp;void&nbsp;loadMetadata(org.jdom2.Element&nbsp;metatdataElement)</pre>
<div class="block">Loads metadata from the given element.  Metadata is things like indexes
 and other configurations the engine may need to save.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>metatdataElement</code> - The element to which metadata should be saved.</dd></dl>
</li>
</ul>
<a name="getId(org.jdom2.Element)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getId</h4>
<pre>protected&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;getId(org.jdom2.Element&nbsp;row)</pre>
<div class="block">gets the string ID from a row element.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>row</code> - The row whose ID is needed</dd>
<dt><span class="strong">Returns:</span></dt><dd>The ID attached to the row</dd></dl>
</li>
</ul>
<a name="setId(org.jdom2.Element, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setId</h4>
<pre>protected&nbsp;void&nbsp;setId(org.jdom2.Element&nbsp;row,
         <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;id)</pre>
<div class="block">set the Id of the given row element to the given ID</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>row</code> - The row whose Id to set</dd><dd><code>id</code> - The new value of the ID.</dd></dl>
</li>
</ul>
<a name="hasUncomittedData()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasUncomittedData</h4>
<pre>protected abstract&nbsp;boolean&nbsp;hasUncomittedData()</pre>
<div class="block">Checks whether this engine has any transactional updates in an uncommitted 
 or unreverted state.
 If so, returns true.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>true if this engine has uncommitted transactional data, false otherwise.</dd></dl>
</li>
</ul>
<a name="commit(org.xflatdb.xflat.transaction.Transaction, org.xflatdb.xflat.transaction.TransactionOptions)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commit</h4>
<pre>public&nbsp;void&nbsp;commit(<a href="../../../../org/xflatdb/xflat/transaction/Transaction.html" title="interface in org.xflatdb.xflat.transaction">Transaction</a>&nbsp;tx,
          <a href="../../../../org/xflatdb/xflat/transaction/TransactionOptions.html" title="class in org.xflatdb.xflat.transaction">TransactionOptions</a>&nbsp;options)
            throws <a href="../../../../org/xflatdb/xflat/transaction/TransactionException.html" title="class in org.xflatdb.xflat.transaction">TransactionException</a>,
                   <a href="../../../../org/xflatdb/xflat/transaction/TransactionStateException.html" title="class in org.xflatdb.xflat.transaction">TransactionStateException</a></pre>
<div class="block">Called when a transaction is committed to write the committed data to disk.
 After this method returns, the data should be stored in non-volatile storage.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tx</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/xflatdb/xflat/transaction/TransactionException.html" title="class in org.xflatdb.xflat.transaction">TransactionException</a></code></dd>
<dd><code><a href="../../../../org/xflatdb/xflat/transaction/TransactionStateException.html" title="class in org.xflatdb.xflat.transaction">TransactionStateException</a></code></dd></dl>
</li>
</ul>
<a name="revert(long, boolean)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>revert</h4>
<pre>public&nbsp;void&nbsp;revert(long&nbsp;tx,
          boolean&nbsp;isRecovering)</pre>
<div class="block">Called when a transaction is committed to revert the given transaction ID.
 This may be called even if a transaction was previously committed in this engine,
 because it was not fully committed across all engines.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tx</code> - </dd><dd><code>isRecovering</code> - true if this transaction is being reverted during recovery
 at startup.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/EngineBase.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/xflatdb/xflat/db/EngineActionEx.html" title="interface in org.xflatdb.xflat.db"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/xflatdb/xflat/db/EngineBase.Row.html" title="class in org.xflatdb.xflat.db"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/xflatdb/xflat/db/EngineBase.html" target="_top">Frames</a></li>
<li><a href="EngineBase.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2014 <a href="http://xflatdb.org/">XFlat</a>. All rights reserved.</small></p>
</body>
</html>
